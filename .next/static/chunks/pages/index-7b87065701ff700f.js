(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{8312:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return n(4406)}])},4406:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return Home}});var a=n(5893),r=n(7294),l=n(7851),s=n(512);function cn(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,l.m)((0,s.W)(t))}let i=r.forwardRef((e,t)=>{let{className:n,...r}=e;return(0,a.jsx)("label",{ref:t,className:cn("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",n),...r})});i.displayName="Label";var o=n(9904);function Switch(e){let{className:t,...n}=e;return(0,a.jsx)(o.r,{...n,className:e=>{let{checked:n}=e;return cn("relative inline-flex h-6 w-11 items-center rounded-full transition",n?"bg-primary":"bg-input",t)},children:e=>{let{checked:t}=e;return(0,a.jsx)("span",{className:cn("inline-block h-4 w-4 transform rounded-full bg-background transition",t?"translate-x-6":"translate-x-1")})}})}var d=n(2003);let c=(0,d.j)("inline-flex items-center justify-center rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 ring-offset-background",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"underline-offset-4 hover:underline text-primary"},size:{default:"h-10 py-2 px-4",sm:"h-9 px-3 rounded-md",lg:"h-11 px-8 rounded-md",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),u=r.forwardRef((e,t)=>{let{className:n,variant:r,size:l,...s}=e;return(0,a.jsx)("button",{className:cn(c({variant:r,size:l}),n),ref:t,...s})});u.displayName="Button";var m=n(9011),h=n(6085),g=n(5327);n(22);var f=n(3977),p=n(1259),x=n(9828),b=n(6650);let v=(0,f.C6)().length?(0,f.Mq)():(0,f.ZF)({apiKey:"AIzaSyAnMPtQh8-e0L3NBNMma-izbfIcnijYK5w",authDomain:"thought-unit-reader.firebaseapp.com",projectId:"thought-unit-reader",storageBucket:"thought-unit-reader.appspot.com",messagingSenderId:"808239475880",appId:"1:808239475880:web:c66b9bf6c553477f78269d",measurementId:"G-5DF8KCFLFG"}),y=(0,p.v0)(v),w=new p.hJ,j=(0,x.ad)(v),N=(0,b.cF)(v);function Home(){let[e,t]=(0,r.useState)(!1),[n,l]=(0,r.useState)(!1),[s,o]=(0,r.useState)(!1),[d,c]=(0,r.useState)(""),[m,f]=(0,r.useState)(null),[v,S]=(0,r.useState)(""),[k,D]=(0,r.useState)(null),[C,E]=(0,r.useState)(null),[_,A]=(0,r.useState)(null),[F,I]=(0,r.useState)(!1),[R,T]=(0,r.useState)("idle");(0,r.useEffect)(()=>{let e=(0,p.Aj)(y,e=>{e&&(A(e),loadSession(e.uid))});return(0,p.cx)(y).then(e=>{(null==e?void 0:e.user)&&(A(e.user),loadSession(e.user.uid))}).catch(e=>console.error("Redirect error",e)),()=>e()},[]);let signIn=async()=>{try{let e=await (0,p.rh)(y,w);A(e.user),await loadSession(e.user.uid)}catch(e){console.error("Sign in error",e),("auth/popup-blocked"===e.code||"auth/popup-closed-by-user"===e.code)&&await (0,p.F6)(y,w)}},loadSession=async e=>{let n=await (0,x.QT)((0,x.JU)(j,"sessions",e));if(n.exists()){let e=n.data();t(e.enabled||!1),D(e.output||null),c(e.fileName||"")}},saveSession=async()=>{_&&await (0,x.pl)((0,x.JU)(j,"sessions",_.uid),{enabled:e,output:k,fileName:d,timestamp:Date.now()})},handleUpload=async e=>{if(!_)return;T("uploading");let t=(0,b.iH)(N,"uploads/".concat(_.uid,"/").concat(e.name));await (0,b.KV)(t,e);let n=await (0,b.Jt)(t);return console.log("File uploaded:",n),T("done"),n},handleFileChange=async e=>{var t;let n=null===(t=e.target.files)||void 0===t?void 0:t[0];if(n){c(n.name);let e=URL.createObjectURL(n);f(e);let t=new FileReader;t.onload=async e=>{var t;let a=null===(t=e.target)||void 0===t?void 0:t.result;"string"==typeof a&&(S(a),await handleUpload(n))},t.readAsText(n)}};return(0,a.jsx)("div",{className:"min-h-screen flex flex-col items-center justify-center bg-gray-100 p-6",children:(0,a.jsxs)("div",{className:"bg-white rounded-2xl shadow-lg p-6 w-full max-w-6xl",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold mb-6 text-center",children:"Thought-Unit Reader"}),!_&&(0,a.jsx)(u,{onClick:signIn,className:"mb-6 w-full bg-green-600 hover:bg-green-700",children:"Sign in with Google"}),_&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"mb-4 flex items-center justify-between",children:[(0,a.jsx)(i,{htmlFor:"toggleParser",className:"text-gray-700",children:"Enable Parser"}),(0,a.jsx)(Switch,{id:"toggleParser",checked:e,onCheckedChange:t})]}),(0,a.jsx)("div",{className:"mb-4",children:(0,a.jsx)("input",{type:"file",accept:".pdf,.docx,.txt",onChange:handleFileChange,className:"block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100"})}),"uploading"===R&&(0,a.jsx)("div",{className:"mt-4 p-2 bg-yellow-100 text-yellow-800 rounded-xl",children:"⏳ Uploading file..."}),"done"===R&&(0,a.jsx)("div",{className:"mt-4 p-2 bg-green-100 text-green-800 rounded-xl",children:"✅ Upload complete!"}),(0,a.jsx)(u,{onClick:()=>{if(!e||!v)return;o(!0),l(!1);let t=function(e){let t=["enzyme-substrate complex","rate-limiting step","Michaelis-Menten kinetics","signal transduction","glycolysis","DNA replication","RNA polymerase","oxidative phosphorylation"],n=e.replace(/\n/g," ").split(RegExp("(?<=[.!?])\\s+")).flatMap(e=>{for(let n of t)e=e.replace(RegExp(n,"gi"),"\xa7".concat(n,"\xa7"));return e.split(RegExp("(?=\xa7)|(?<=\xa7)"))}),a=!0;return n.map(e=>{let t=e.replace(/§/g,""),n=a?"black":"gray";return t.trim()?(a=!a,'<span style="color:'.concat(n,'">').concat(t.trim()," </span>")):""}).join("")}(v);setTimeout(()=>{D(t),l(!0),o(!1),saveSession(),setTimeout(()=>{let e=document.getElementById("thought-output");e&&e.scrollIntoView({behavior:"smooth"})},300)},800)},className:"w-full mt-4 bg-blue-600 hover:bg-blue-700 text-white rounded-xl transition",children:s?"Parsing...":"Start Parsing"}),v&&(0,a.jsxs)("div",{className:"my-6 bg-white p-4 rounded-xl shadow",children:[(0,a.jsx)("h2",{className:"font-semibold text-lg mb-2",children:"\uD83D\uDCDA Table of Contents"}),(0,a.jsx)("ul",{className:"text-sm space-y-1 max-h-48 overflow-y-auto",children:Array.from(v.matchAll(/^(Chapter|Section|\d+(\.\d+)*)[^\n]{0,80}/gim)).map(e=>e[0].trim()).map((e,t)=>(0,a.jsxs)("li",{className:"text-blue-700",children:["\uD83D\uDD39 ",e]},t))})]}),n&&(0,a.jsx)("div",{className:"mt-4 p-4 bg-green-100 text-green-800 rounded-xl",children:"✅ Parsing complete!"}),m&&(0,a.jsxs)("div",{className:"mt-6 grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"bg-gray-50 p-4 rounded-xl overflow-auto max-h-[80vh]",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold mb-2",children:"\uD83D\uDCD8 Original Book View"}),(0,a.jsx)(h.Z,{file:m,onLoadSuccess:e=>{let{numPages:t}=e;return E(t)},children:Array.from(Array(C),(e,t)=>(0,a.jsx)(g.Z,{pageNumber:t+1},"page_".concat(t+1)))})]}),(0,a.jsxs)("div",{id:"thought-output",className:"bg-white p-4 rounded-xl shadow-inner overflow-y-auto max-h-[80vh]",children:[(0,a.jsxs)("div",{className:"flex justify-between mb-2",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold",children:"\uD83E\uDDE0 Thought-Unit Output"}),(0,a.jsx)(u,{onClick:()=>I(!F),children:F?"Disable Edit":"Improve Parser"})]}),(0,a.jsx)("div",{className:"text-gray-700 whitespace-pre-wrap text-sm",contentEditable:F,suppressContentEditableWarning:!0,dangerouslySetInnerHTML:{__html:k||"No output yet. Start the parser to generate content."}})]})]})]})]})})}m.Tu.workerSrc="//cdnjs.cloudflare.com/ajax/libs/pdf.js/".concat(m.i8,"/pdf.worker.min.js")}},function(e){e.O(0,[774,185,16,257,307,888,179],function(){return e(e.s=8312)}),_N_E=e.O()}]);